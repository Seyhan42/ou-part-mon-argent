<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard â€” OÃ¹ part mon argent ?</title>
  <link rel="stylesheet" href="css/style.css?v=5">
  <link rel="stylesheet" href="css/dashboard.css?v=5">
</head>
<body>

<header class="header">
  <div class="brand">
    <div class="logo">â‚¬</div>
    <div>
      <div class="brand-title">OÃ¹ part mon argent ?</div>
      <div class="brand-subtitle">ClartÃ© â€¢ Ã‰pargne â€¢ DÃ©cisions</div>
    </div>
  </div>
  <nav class="nav">
    <a class="nav-link" href="index.html">Accueil</a>
    <a class="nav-link" href="test.html">Test gratuit</a>
    <a class="nav-link" href="tarifs.html">Tarifs</a>
    <a class="nav-link" href="login.html" data-auth="out">Connexion</a>
    <a class="nav-link active" href="dashboard.html" data-auth="in">Dashboard</a>
    <button class="btn-ghost" type="button" data-auth="in" data-logout>DÃ©connexion</button>
  </nav>
</header>

<main class="dashboard">
  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" data-tab="apercu">ğŸ“Š AperÃ§u</button>
    <button class="tab" data-tab="mouvements">ğŸ“‹ Mouvements</button>
    <button class="tab" data-tab="outils">ğŸ› ï¸ Outils</button>
  </div>

  <!-- ==================== APERÃ‡U ==================== -->
  <div class="tab-content active" id="tab-apercu">
    
    <!-- Diagnostic automatique -->
    <div class="diagnostic-card" id="diagnostic-card">
      <div class="diagnostic-icon" id="diagnostic-icon">ğŸ¯</div>
      <div class="diagnostic-text" id="diagnostic-text">Chargement...</div>
      <div class="diagnostic-sub" id="diagnostic-sub"></div>
    </div>
    
    <!-- Stats principales -->
    <div class="grid-4">
      <div class="stat-card">
        <div class="stat-label">ğŸ’µ Revenus</div>
        <div class="stat-value" id="stat-revenus">0 â‚¬</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ğŸ  Essentielles</div>
        <div class="stat-value" id="stat-essentielles">0 â‚¬</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ğŸ›ï¸ Non essentielles</div>
        <div class="stat-value" id="stat-non-essentielles">0 â‚¬</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">âœ¨ Reste Ã  vivre</div>
        <div class="stat-value positive" id="stat-reste">0 â‚¬</div>
      </div>
    </div>

    <div class="grid-2 mt-lg">
      <!-- Score -->
      <div class="card">
        <h3 style="text-align:center;margin-bottom:0">Score santÃ© financiÃ¨re</h3>
        <div class="score-section">
          <div class="score-circle-container">
            <svg width="160" height="160" viewBox="0 0 160 160">
              <circle class="score-circle-bg" cx="80" cy="80" r="70"/>
              <circle class="score-circle-fill" id="score-circle" cx="80" cy="80" r="70" 
                stroke-dasharray="440" stroke-dashoffset="440"/>
            </svg>
            <div class="score-value-container">
              <div class="score-number" id="score-number">0</div>
              <div class="score-label">/ 100</div>
            </div>
          </div>
          <span class="badge" id="score-badge">â€”</span>
          
          <!-- Facteurs du score -->
          <div class="score-factors">
            <div class="score-factors-title">Pourquoi ce score ?</div>
            <div id="score-factors-list"></div>
          </div>
        </div>
      </div>

      <!-- Missions -->
      <div class="card">
        <h3>ğŸ¯ Missions de la semaine</h3>
        <div class="missions-container" id="missions-list"></div>
        <div style="text-align:center;margin-top:16px">
          <span class="badge success" id="missions-progress">0/3 complÃ©tÃ©es</span>
        </div>
      </div>
    </div>

    <!-- Objectif Ã©pargne -->
    <div class="epargne-card">
      <div class="epargne-header">
        <div>
          <div class="epargne-title">ğŸ’ Objectif Ã©pargne</div>
          <div class="epargne-objectif" id="epargne-objectif-text">Aucun objectif dÃ©fini</div>
        </div>
        <button class="btn btn-ghost" style="background:rgba(255,255,255,0.2);color:#fff;border:none" onclick="Dashboard.openModal('modal-epargne')">âš™ï¸ Configurer</button>
      </div>
      <div class="epargne-progress">
        <div class="epargne-progress-fill" id="epargne-progress" style="width:0%"></div>
      </div>
      <div class="epargne-stats">
        <div class="epargne-stat">
          <div class="epargne-stat-value" id="epargne-total">0 â‚¬</div>
          <div class="epargne-stat-label">Total Ã©pargnÃ©</div>
        </div>
        <div class="epargne-stat highlight">
          <div class="epargne-stat-value" id="epargne-mois">0 â‚¬</div>
          <div class="epargne-stat-label">Ce mois-ci</div>
        </div>
        <div class="epargne-stat">
          <div class="epargne-stat-value" id="epargne-restant">0 â‚¬</div>
          <div class="epargne-stat-label">Restant</div>
        </div>
        <div class="epargne-stat">
          <div class="epargne-stat-value" id="epargne-conseille">0 â‚¬</div>
          <div class="epargne-stat-label">ConseillÃ©/mois</div>
        </div>
      </div>
    </div>

    <!-- Projection fin de mois -->
    <div class="projection-card" id="projection-container" style="display:none">
      <div class="projection-header">
        <span>ğŸ“ˆ</span>
        <div class="projection-title">Projection fin de mois</div>
      </div>
      <div>
        <span class="projection-value" id="projection-value">0 â‚¬</span>
        <span style="font-size:14px;color:var(--text-muted);margin-left:8px" id="projection-days"></span>
      </div>
    </div>

    <!-- Dernier test -->
    <div class="last-test-card" id="last-test-container"></div>
  </div>

  <!-- ==================== MOUVEMENTS ==================== -->
  <div class="tab-content" id="tab-mouvements">
    <div class="journal-header">
      <div>
        <h2>ğŸ“‹ Journal des mouvements</h2>
        <p class="muted small">Toutes vos entrÃ©es et sorties d'argent</p>
      </div>
      <button class="btn btn-primary" onclick="Dashboard.openModal('modal-movement')">+ Ajouter</button>
    </div>

    <div class="journal-filters">
      <button class="filter-btn active" data-filter="all">Tous</button>
      <button class="filter-btn" data-filter="revenu">ğŸ’µ Revenus</button>
      <button class="filter-btn" data-filter="epargne">ğŸ’ Ã‰pargne</button>
      <button class="filter-btn" data-filter="essentiel">ğŸ  Essentielles</button>
      <button class="filter-btn" data-filter="non-essentiel">ğŸ›ï¸ Non ess.</button>
      <button class="filter-btn" data-filter="imprevu">ğŸš¨ ImprÃ©vus</button>
    </div>

    <div class="card">
      <div class="movement-list" id="movement-list"></div>
    </div>

    <!-- RÃ©sumÃ© du mois -->
    <div class="card mt-lg">
      <h3>ğŸ“Š RÃ©sumÃ© du mois</h3>
      <div class="month-summary">
        <div class="summary-card entrees">
          <div class="summary-value positive" id="resume-entrees">+0 â‚¬</div>
          <div class="summary-label">EntrÃ©es</div>
        </div>
        <div class="summary-card sorties">
          <div class="summary-value negative" id="resume-sorties">-0 â‚¬</div>
          <div class="summary-label">Sorties</div>
        </div>
        <div class="summary-card solde">
          <div class="summary-value" id="resume-solde">0 â‚¬</div>
          <div class="summary-label">Solde</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== OUTILS ==================== -->
  <div class="tab-content" id="tab-outils">
    
    <!-- Comparateur -->
    <div class="tool-card" id="tool-comparateur">
      <div class="tool-header">
        <div class="tool-icon">âš–ï¸</div>
        <div class="tool-info">
          <div class="tool-title">Comparateur de dÃ©cisions</div>
          <div class="tool-desc">Comparez deux choix et leur impact sur votre budget</div>
        </div>
        <span class="badge pro">PRO</span>
      </div>
      <div class="tool-content">
        <div class="compare-grid">
          <div class="compare-box a">
            <div class="compare-label">
              <div class="compare-badge a">A</div>
              <input type="text" id="compare-a-nom" placeholder="Nom du choix A" style="border:none;background:transparent;font-weight:600;flex:1;font-size:14px">
            </div>
            <div class="field"><label>CoÃ»t mensuel (â‚¬)</label><input type="number" id="compare-a-cout" placeholder="0"></div>
            <div class="field mt-sm"><label>DurÃ©e (mois)</label><input type="number" id="compare-a-duree" placeholder="12" value="12"></div>
          </div>
          <div class="compare-box b">
            <div class="compare-label">
              <div class="compare-badge b">B</div>
              <input type="text" id="compare-b-nom" placeholder="Nom du choix B" style="border:none;background:transparent;font-weight:600;flex:1;font-size:14px">
            </div>
            <div class="field"><label>CoÃ»t mensuel (â‚¬)</label><input type="number" id="compare-b-cout" placeholder="0"></div>
            <div class="field mt-sm"><label>DurÃ©e (mois)</label><input type="number" id="compare-b-duree" placeholder="12" value="12"></div>
          </div>
        </div>
        <div style="text-align:center;margin-top:24px">
          <button class="btn btn-primary" onclick="Dashboard.comparer()">âš–ï¸ Comparer</button>
        </div>
        <div class="compare-result" id="compare-result" style="display:none"></div>
      </div>
      <div class="locked-overlay">
        <div class="locked-icon">ğŸ”’</div>
        <div class="locked-title">Plan Essentiel requis</div>
        <div class="locked-desc">Comparez vos choix financiers et prenez de meilleures dÃ©cisions</div>
        <a href="tarifs.html" class="btn btn-primary">DÃ©bloquer</a>
      </div>
    </div>

    <!-- Simulateur -->
    <div class="tool-card" id="tool-simulateur">
      <div class="tool-header">
        <div class="tool-icon">ğŸš¨</div>
        <div class="tool-info">
          <div class="tool-title">Simulateur d'imprÃ©vu</div>
          <div class="tool-desc">Testez la rÃ©sistance de votre budget face aux imprÃ©vus</div>
        </div>
        <span class="badge max">MAX</span>
      </div>
      <div class="tool-content">
        <div class="grid-2">
          <div class="field">
            <label>Type d'imprÃ©vu</label>
            <select id="imprevu-type">
              <option value="reparation">ğŸ”§ RÃ©paration voiture</option>
              <option value="sante">ğŸ¥ Frais mÃ©dicaux</option>
              <option value="maison">ğŸ  Travaux maison</option>
              <option value="appareil">ğŸ“± Remplacement appareil</option>
              <option value="autre">ğŸ“¦ Autre</option>
            </select>
          </div>
          <div class="field">
            <label>Montant (â‚¬)</label>
            <input type="number" id="imprevu-montant" placeholder="1500">
          </div>
        </div>
        <div class="field mt-md">
          <label>Ã‰taler sur (mois)</label>
          <input type="number" id="imprevu-mois" value="3" min="1" max="24">
        </div>
        <button class="btn btn-primary mt-lg" style="width:100%" onclick="Dashboard.simuler()">ğŸš¨ Simuler l'impact</button>
        <div id="simulateur-result"></div>
      </div>
      <div class="locked-overlay">
        <div class="locked-icon">ğŸ”’</div>
        <div class="locked-title">Plan Complet requis</div>
        <div class="locked-desc">Anticipez les imprÃ©vus et sÃ©curisez votre budget</div>
        <a href="tarifs.html" class="btn btn-primary">DÃ©bloquer</a>
      </div>
    </div>

    <!-- PrÃ©lÃ¨vements -->
    <div class="tool-card" id="tool-prelevements">
      <div class="tool-header">
        <div class="tool-icon">ğŸ“…</div>
        <div class="tool-info">
          <div class="tool-title">PrÃ©lÃ¨vements Ã  venir</div>
          <div class="tool-desc">Suivez vos dÃ©penses rÃ©currentes</div>
        </div>
        <span class="badge pro">PRO</span>
      </div>
      <div class="tool-content">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div style="font-size:14px;color:var(--text-muted)">Total mensuel:</div>
          <div style="font-size:20px;font-weight:700;color:var(--danger)" id="prelevements-total">0 â‚¬</div>
        </div>
        <div id="prelevements-list"></div>
        <button class="btn btn-secondary mt-md" onclick="Dashboard.openModal('modal-prelevement')">+ Ajouter un prÃ©lÃ¨vement</button>
      </div>
      <div class="locked-overlay">
        <div class="locked-icon">ğŸ”’</div>
        <div class="locked-title">Plan Essentiel requis</div>
        <div class="locked-desc">Gardez un Å“il sur vos prÃ©lÃ¨vements automatiques</div>
        <a href="tarifs.html" class="btn btn-primary">DÃ©bloquer</a>
      </div>
    </div>

    <!-- Gestion abonnement -->
    <div class="tool-card">
      <div class="tool-header">
        <div class="tool-icon">â­</div>
        <div class="tool-info">
          <div class="tool-title">GÃ©rer mon abonnement</div>
          <div class="tool-desc">Modifier ou annuler votre plan</div>
        </div>
      </div>
      <div class="tool-content">
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <a href="tarifs.html" class="btn btn-primary">Voir les offres</a>
          <button class="btn btn-ghost" onclick="alert('Portail Stripe Ã  configurer')">Portail client Stripe</button>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- ==================== MODALS ==================== -->

<!-- Modal Mouvement -->
<div class="modal" id="modal-movement">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title" id="modal-movement-title">Ajouter un mouvement</h3>
      <button class="modal-close" data-close="modal-movement">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="type-selector">
        <div class="type-option" data-type="revenu">
          <div class="type-option-icon">ğŸ’µ</div>
          <div class="type-option-label">Revenu</div>
        </div>
        <div class="type-option" data-type="epargne">
          <div class="type-option-icon">ğŸ’</div>
          <div class="type-option-label">Ã‰pargne</div>
        </div>
        <div class="type-option" data-type="essentiel">
          <div class="type-option-icon">ğŸ </div>
          <div class="type-option-label">Essentielle</div>
        </div>
        <div class="type-option" data-type="non-essentiel">
          <div class="type-option-icon">ğŸ›ï¸</div>
          <div class="type-option-label">Non ess.</div>
        </div>
        <div class="type-option" data-type="imprevu">
          <div class="type-option-icon">ğŸš¨</div>
          <div class="type-option-label">ImprÃ©vu</div>
        </div>
      </div>
      <div class="field">
        <label>Description</label>
        <input type="text" id="movement-desc" placeholder="Ex: Salaire, Loyer, Netflix...">
      </div>
      <div class="field mt-md">
        <label>Montant (â‚¬)</label>
        <input type="number" id="movement-amount" placeholder="0" step="0.01">
      </div>
      <div class="field mt-md">
        <label>Date</label>
        <input type="date" id="movement-date">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" data-close="modal-movement">Annuler</button>
      <button class="btn btn-primary" onclick="Dashboard.saveMovement()">Enregistrer</button>
    </div>
  </div>
</div>

<!-- Modal Ã‰pargne -->
<div class="modal" id="modal-epargne">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Objectif Ã©pargne</h3>
      <button class="modal-close" data-close="modal-epargne">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <label>Nom de l'objectif</label>
        <input type="text" id="epargne-nom" placeholder="Ex: Voiture, Vacances, Apport maison...">
      </div>
      <div class="field mt-md">
        <label>Montant objectif (â‚¬)</label>
        <input type="number" id="epargne-objectif-input" placeholder="10000">
      </div>
      <div class="field mt-md">
        <label>DÃ©jÃ  Ã©pargnÃ© avant ce mois (â‚¬)</label>
        <input type="number" id="epargne-deja" placeholder="0">
        <p class="hint">L'Ã©pargne du mois en cours sera automatiquement ajoutÃ©e depuis vos mouvements.</p>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" data-close="modal-epargne">Annuler</button>
      <button class="btn btn-primary" onclick="Dashboard.saveEpargne()">Enregistrer</button>
    </div>
  </div>
</div>

<!-- Modal PrÃ©lÃ¨vement -->
<div class="modal" id="modal-prelevement">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Ajouter un prÃ©lÃ¨vement</h3>
      <button class="modal-close" data-close="modal-prelevement">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <label>Nom du prÃ©lÃ¨vement</label>
        <input type="text" id="prelevement-nom" placeholder="Ex: Netflix, EDF, Assurance...">
      </div>
      <div class="field mt-md">
        <label>Montant mensuel (â‚¬)</label>
        <input type="number" id="prelevement-montant" placeholder="15.99" step="0.01">
      </div>
      <div class="field mt-md">
        <label>Jour du mois</label>
        <input type="number" id="prelevement-jour" placeholder="15" min="1" max="31">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" data-close="modal-prelevement">Annuler</button>
      <button class="btn btn-primary" onclick="Dashboard.savePrelevement()">Ajouter</button>
    </div>
  </div>
</div>

<footer class="footer">
  <a href="tarifs.html">Tarifs</a> Â·
  <a href="test.html">Test gratuit</a> Â·
  <a href="index.html">Accueil</a>
</footer>

<script src="assets/nav-auth.js"></script>
<script src="js/dashboard.js?v=5"></script>

</body>
</html>