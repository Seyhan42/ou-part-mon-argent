<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connexion — Où part mon argent ?</title>

  <!-- Ton CSS global -->
  <link rel="stylesheet" href="/css/style.css?v=2" />
</head>

<body>
  <header class="header">
    <div class="header-container">
      <a href="/index.html" class="logo">€</a>

      <nav class="top-nav" id="nav">
        <a href="/index.html">Accueil</a>
        <a href="/test.html">Test gratuit</a>
        <a href="/tarifs.html">Tarifs</a>

        <a href="/login.html" data-auth="logged-out" class="active">Connexion</a>

        <a href="/dashboard.html" data-auth="logged-in">Dashboard</a>
        <a href="#" data-auth="logged-in" data-action="logout">Déconnexion</a>
      </nav>
    </div>
  </header>

  <main class="container" style="padding:32px 16px;max-width:520px;">
    <h1 style="margin-bottom:8px;">Connexion</h1>
    <p style="margin-bottom:18px;opacity:.8;">
      Connectez-vous pour accéder à votre dashboard.
    </p>

    <form id="loginForm" style="display:grid;gap:12px;">
      <div>
        <label>Email</label>
        <input id="email" type="email" required placeholder="email@example.com" />
      </div>

      <div>
        <label>Mot de passe</label>
        <input id="password" type="password" required placeholder="••••••••" />
      </div>

      <button type="submit" class="btn">Se connecter</button>
      <p id="msg" style="font-size:14px;opacity:.75;"></p>
    </form>

    <hr style="margin:22px 0;opacity:.2;">

    <p style="margin-bottom:10px;font-weight:600;">Pas encore de compte ?</p>
    <a class="btn btn-ghost" href="/register.html">Créer un compte</a>
  </main>

  <script src="/nav-auth.js"></script>
  <script>
    // Si déjà connecté -> dashboard
    if (localStorage.getItem("auth") === "1") {
      window.location.href = "/dashboard.html";
    }

    document.getElementById("loginForm").addEventListener("submit", function(e){
      e.preventDefault();

      // MVP : on active l'état connecté (local)
      if (window.authManager && typeof window.authManager.login === "function") {
        window.authManager.login();
      } else {
        localStorage.setItem("auth","1");
      }

      window.location.href = "/dashboard.html";
    });
  </script>
</body>
</html>
